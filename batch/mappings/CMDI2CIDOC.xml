<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE doc [
	<!ENTITY objectProperties SYSTEM "object.xml">
	<!ENTITY datasetProperties SYSTEM "dataset.xml">
]>
<mappings>

	<!-- Header -->
	<entity xpath="/cmd:CMD" type="crmpe:PE22_Persistent_Dataset" hasType="metadata">
		
		<link>			
			<entity relationship="crm:P1_is_identified_by" type="crm:E42_Identifier" />			
			<pattern>cmd:Header/cmd:MdSelfLink</pattern>
		</link>
		
		<link>			
			<entity relationship="crmpe:PP23i_is_dataset_part_of" type="crmpe:PE24_Volatile_Dataset" hasType="collection" />		
			<pattern>cmd:Header/cmd:MdCollectionDisplayName</pattern>
		</link>
		
		<link>
			<entity xpath="/cmd:CMD/cmd:Header" relationship="crmdig:L11i_was_output_of" type="crmdig:D7_Digital_Machine_Event">
				<link>			
					<entity relationship="crm:P94i_was_created_by" type="crm:E65_Creation"/>
					<entity relationship="crm:P4_has_time-span" type="crm:E52_Time-Span" />
					<entity relationship="crm:P82_at_some_time_within" type="http://www.w3.org/2000/01/rdf-schema#Literal" />
					<pattern>cmd:MdCreationDate</pattern>
				</link>
				
				<link>			
					<entity relationship="crm:P11_had_participant" type="crm:E39_Actor" condition="creator-actor" />
					<entity relationship="crmdig:L23_used_software_or_firmware" type="crmdig:D14_Software" condition="creator-software"/>
					<pattern>cmd:MdCreator</pattern>
				</link>
				
				<link>			
					<entity relationship="crmdig:L23_used_software_or_firmware" type="crmdig:D14_Software" hasType="cmdi-profile"/>
					<pattern>cmd:MdProfile</pattern>
				</link>
			</entity>
			<pattern>cmd:Header</pattern>
		</link>
		
		
		<link>			
			<entity relationship="crmpe:PP39_is_metadata_for" type="crmpe:PE24_Volatile_Dataset" globVar="mainEntity" />
			<entity relationship="crmpe:PP8i_is_dataset_hosted_by" type="crmpe:PE15_Data_E-Service" globVar="des1" />
			<entity relationship="crmpe:PP28_has_designated_access_point" type="crmpe:PE29_Access_Point" />
			<pattern>cmd:Resources/cmd:ResourceProxyList/cmd:ResourceProxy</pattern>
		</link>
		
		<!-- Only one of these entities will be mapped -->
		<link>
		
			<!-- Dataset -->
			<entity xpath="/cmd:CMD/cmd:Components/?profileRoot" relationship="crmpe:PP39_is_metadata_for" type="crmpe:PE24_Volatile_Dataset" globVar="mainEntity" condition="dataset">
				&objectProperties;
				&datasetProperties;
			</entity>
			
			<!-- Service -->
			<entity xpath="/cmd:CMD/cmd:Components/?profileRoot?" relationship="crm:P129_is_about" type="crmpe:PE8_E-Service" globVar="mainEntity" condition="service">
				&objectProperties;
			</entity>
			
			<!-- Software -->
			
			<pattern>cmd:Components/?profileRoot</pattern>
		</link>
		
	</entity>
	
	<entity xpath="/cmd:CMD/cmd:Resources/cmd:ResourceProxyList/cmd:ResourceProxy" type="crmpe:PE29_Access_Point">
		
		<link>			
			<entity relationship="crm:P2_has_type" type="crm:E55_Type" />		
			<pattern>cmd:ResourceType</pattern>
		</link>
		
		<link>			
			<entity relationship="crm:P1i_identifies" type="crmpe:PE24_Volatile_Dataset" globVar="mainEntity" />		
			<pattern>cmd:ResourceRef</pattern>
		</link>
		
		<link>			
			<entity relationship="crmpe:PP28i_is_designated_access_point_of" type="crmpe:PE15_Data_E-Service" globVar="des1" />
			<entity relationship="crmpe:PP8_hosts_dataset" type="crmpe:PE24_Volatile_Dataset" globVar="mainEntity" />		
			<pattern>../../../cmd:Components/?profileRoot</pattern>
		</link>
			
	</entity>

</mappings>